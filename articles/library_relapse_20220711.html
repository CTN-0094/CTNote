<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="CTNote">
<title>CTNote Library: Relapse Outcomes • CTNote</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="CTNote Library: Relapse Outcomes">
<meta property="og:description" content="CTNote">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">CTNote</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9016</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/library_abstinence_20220711.html">CTNote Library: Abstinence Outcomes</a>
    <a class="dropdown-item" href="../articles/library_reduction_20220630.html">CTNote Library: Reduction Outcomes</a>
    <a class="dropdown-item" href="../articles/library_relapse_20220711.html">CTNote Library: Relapse Outcomes</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="library_relapse_20220711_files/kePrint-0.0.1/kePrint.js"></script><link href="library_relapse_20220711_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>CTNote Library: Relapse Outcomes</h1>
                        <h4 data-toc-skip class="author">Gabriel Odom, Laura Brandt, Sean Luo, and Ray Balise</h4>
            
            <h4 data-toc-skip class="date">2022-09-27</h4>
      
      
      <div class="d-none name"><code>library_relapse_20220711.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This document contains the algorithms necessary to code all the outcomes which measure “abstinence from substance use” or “relapse to substance use”. We only include outcomes which result in a single value per subject. These outcomes are:</p>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:500px; overflow-x: scroll; width:1000px; ">
<table class="table table table-striped lightable-minimal" style='font-size: 11px; margin-left: auto; margin-right: auto; font-family: "Trebuchet MS", verdana, sans-serif; margin-left: auto; margin-right: auto;'>
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Group
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Endpoint
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Class
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Reference
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Definition
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Missing is
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;width: 3cm; ">
Relapse
</td>
<td style="text-align:left;width: 3cm; ">
Time to relapse
</td>
<td style="text-align:left;width: 3cm; ">
survival
</td>
<td style="text-align:left;width: 3cm; ">
CTN-0094
</td>
<td style="text-align:left;width: 5cm; ">
Weeks to relapse (4 consecutive weeks of positive UOS)
</td>
<td style="text-align:left;">
Positive
</td>
</tr>
<tr>
<td style="text-align:left;width: 3cm; ">
Relapse
</td>
<td style="text-align:left;width: 3cm; ">
Time to study dropout
</td>
<td style="text-align:left;width: 3cm; ">
survival
</td>
<td style="text-align:left;width: 3cm; ">
CTN-0094
</td>
<td style="text-align:left;width: 5cm; ">
Weeks to study dropout (4 consecutive weeks of missing UOS)
</td>
<td style="text-align:left;">
Missing
</td>
</tr>
<tr>
<td style="text-align:left;width: 3cm; ">
Relapse
</td>
<td style="text-align:left;width: 3cm; ">
Relapse/failure rate
</td>
<td style="text-align:left;width: 3cm; ">
logical
</td>
<td style="text-align:left;width: 3cm; ">
Johnson, Jaffe, &amp; Fudala, 1992
</td>
<td style="text-align:left;width: 5cm; ">
Failure rate: 2 consecutive positive UOS following 4 weeks of treatment
</td>
<td style="text-align:left;">
Positive
</td>
</tr>
<tr>
<td style="text-align:left;width: 3cm; ">
Relapse
</td>
<td style="text-align:left;width: 3cm; ">
Relapse/failure rate
</td>
<td style="text-align:left;width: 3cm; ">
logical
</td>
<td style="text-align:left;width: 3cm; ">
Krupitsky et al., 2004
</td>
<td style="text-align:left;width: 5cm; ">
Relapse rate (3 consecutive positive UOS)
</td>
<td style="text-align:left;">
Positive
</td>
</tr>
<tr>
<td style="text-align:left;width: 3cm; ">
Relapse
</td>
<td style="text-align:left;width: 3cm; ">
Relapse/failure rate
</td>
<td style="text-align:left;width: 3cm; ">
logical
</td>
<td style="text-align:left;width: 3cm; ">
Krupitsky et al., 2006
</td>
<td style="text-align:left;width: 5cm; ">
Relapse rate (3 consecutive positive UOS)
</td>
<td style="text-align:left;">
Positive
</td>
</tr>
<tr>
<td style="text-align:left;width: 3cm; ">
Relapse
</td>
<td style="text-align:left;width: 3cm; ">
Time to opioid use/relapse
</td>
<td style="text-align:left;width: 3cm; ">
survival
</td>
<td style="text-align:left;width: 3cm; ">
Lee et al., 2016
</td>
<td style="text-align:left;width: 5cm; ">
Weeks to relapse (≥10 days of opioid use in a 28‐day period [a positive UOS was computed as 5 days of opioid use])
</td>
<td style="text-align:left;">
Positive
</td>
</tr>
<tr>
<td style="text-align:left;width: 3cm; ">
Relapse
</td>
<td style="text-align:left;width: 3cm; ">
Time to opioid use/relapse
</td>
<td style="text-align:left;width: 3cm; ">
survival
</td>
<td style="text-align:left;width: 3cm; ">
Lee et al., 2018 CTN-0051
</td>
<td style="text-align:left;width: 5cm; ">
Weeks to relapse (starting at day 21 post-randomization: 4 consecutive weeks with positive UOS)
</td>
<td style="text-align:left;">
Positive
</td>
</tr>
<tr>
<td style="text-align:left;width: 3cm; ">
Relapse
</td>
<td style="text-align:left;width: 3cm; ">
Time to opioid use/relapse
</td>
<td style="text-align:left;width: 3cm; ">
survival
</td>
<td style="text-align:left;width: 3cm; ">
Schottenfeld et al., 2008
</td>
<td style="text-align:left;width: 5cm; ">
Days to relapse (3 consecutive positive UOS)
</td>
<td style="text-align:left;">
Positive
</td>
</tr>
</tbody>
</table>
</div>
<p>We will use the table of participant opioid use patterns from the <code>ctn0094DataExtra</code> package to calculate these endpoints (we have a copy of the endpoints in the dataset <code>outcomesCTN0094</code>). Importantly, if you wish to apply these algorithms to calculate endpoints for your data, the participants’ substance use patterns must be stored in the “substance use pattern word” format shown here. We also show a subset of the data to visualize a variety of different real substance use patterns.</p>
<p>We first define the following five-value legend:</p>
<ul>
<li>
<strong>+</strong>: positive for the substance(s) in a specified window of time (a day, week, month, etc.) by urine screen (or participant self report, if such data are of interest)</li>
<li>
<strong>–</strong>: negative for the substance(s)</li>
<li>
<strong>o</strong>: subject failed to provide a urine sample</li>
<li>
<b>*</b>: inconclusive results or mixed results (e.g. subject provided more than one urine sample in the time interval and they did not agree)</li>
<li>
<b>_</b>: no specimens required (weekends, holidays, pre-randomization period, alternating visit days/weeks)</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">###  Full Data  ###</span></span>
<span><span class="va">udsOutcomes_df</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu">CTNote</span><span class="fu">::</span><span class="va"><a href="../reference/outcomesCTN0094.html">outcomesCTN0094</a></span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">who</span>, <span class="va">usePatternUDS</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Make a copy</span></span>
<span><span class="va">outcomesRel_df</span> <span class="op">&lt;-</span> <span class="va">udsOutcomes_df</span></span>
<span></span>
<span></span>
<span><span class="co">###  Examples  ###</span></span>
<span><span class="va">examplePeople_int</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">163</span>, <span class="fl">210</span>, <span class="fl">242</span>, <span class="fl">4</span>, <span class="fl">17</span>, <span class="fl">13</span>, <span class="fl">1103</span>, <span class="fl">233</span>, <span class="fl">2089</span><span class="op">)</span></span>
<span><span class="va">outcomesRel_df</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">who</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">examplePeople_int</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 10 × 2</span></span></span>
<span><span class="co">##      who usePatternUDS                      </span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                              </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>     1 ooooooooooooooo                    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>     4 -------------------o-o-o           </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>    13 ------------o-oooooooooo           </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>    17 --++*++++++-++++++-+++-            </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>   163 -o---o---o--o+----------           </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>   210 -++++++++-+++-----------           </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>   233 *+++++++++++o++++++++++o           </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>   242 -----------------------            </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>  <span style="text-decoration: underline;">1</span>103 ++--oo--o-+-+--o----------o-o-oo++o</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>  <span style="text-decoration: underline;">2</span>089 ++++---+--------------o-</span></span></code></pre>
<p>For example, participant 1 has a use pattern <code>ooooooooooooooo</code> (all missing UDS), which means that they dropped out of the study. In contrast, participant 233 has a use pattern <code>*+++++++++++o++++++++++o</code> (nearly all positive UDS): they did not drop out of the study, but the treatment was completely ineffective for them. Participant 2089 started the study in a rough patch, but greatly improved in treatment over time (<code>++++---+--------------o-</code>).</p>
<hr>
<p></p>
</div>
<div class="section level2">
<h2 id="relapse-to-substance-use-endpoints">“Relapse to Substance Use” Endpoints<a class="anchor" aria-label="anchor" href="#relapse-to-substance-use-endpoints"></a>
</h2>
<div class="section level3">
<h3 id="ctn-0094-endpoints">CTN-0094 Endpoints<a class="anchor" aria-label="anchor" href="#ctn-0094-endpoints"></a>
</h3>
<p>Our <a href="http://ctndisseminationlibrary.org/protocols/ctn0094.htm" class="external-link">CTN-0094 research group</a> has two relapse outcomes: Weeks to relapse (4 consecutive weeks of positive UOS) and Weeks to study dropout (4 consecutive weeks of missing UOS).</p>
<div class="section level4">
<h4 id="ctn-0094-relapse">CTN-0094 Relapse<a class="anchor" aria-label="anchor" href="#ctn-0094-relapse"></a>
</h4>
<p><strong>Definition</strong>: Weeks to relapse (4 consecutive weeks of positive UOS); missing is positive</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outcomesRel_df</span> <span class="op">&lt;-</span> </span>
<span>    <span class="va">outcomesRel_df</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">rowwise</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>        udsPattern <span class="op">=</span> <span class="fu"><a href="../reference/recode_missing_visits.html">recode_missing_visits</a></span><span class="op">(</span></span>
<span>            use_pattern <span class="op">=</span> <span class="va">usePatternUDS</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">mutate</span><span class="op">(</span></span>
<span>        udsPattern <span class="op">=</span> <span class="fu"><a href="../reference/recode_missing_visits.html">recode_missing_visits</a></span><span class="op">(</span></span>
<span>            use_pattern <span class="op">=</span> <span class="va">udsPattern</span>,</span>
<span>            missing_is <span class="op">=</span> <span class="st">"*"</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>        ctn0094_relapse <span class="op">=</span> <span class="fu"><a href="../reference/detect_in_window.html">detect_in_window</a></span><span class="op">(</span></span>
<span>            use_pattern <span class="op">=</span> <span class="va">udsPattern</span>,</span>
<span>            window_width <span class="op">=</span> <span class="fl">4L</span>,</span>
<span>            threshold <span class="op">=</span> <span class="fl">4L</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">unnest</span><span class="op">(</span>cols <span class="op">=</span> <span class="st">"ctn0094_relapse"</span>, names_sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">select</span><span class="op">(</span><span class="va">who</span>, <span class="fu">starts_with</span><span class="op">(</span><span class="st">"ctn0094_relapse"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">left_join</span><span class="op">(</span><span class="va">outcomesRel_df</span>, <span class="va">.</span>, by <span class="op">=</span> <span class="st">"who"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">outcomesRel_df</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">who</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">examplePeople_int</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">who</span>, <span class="va">usePatternUDS</span>, <span class="fu">starts_with</span><span class="op">(</span><span class="st">"ctn0094_relapse"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 10 × 4</span></span></span>
<span><span class="co">##      who usePatternUDS                       ctn0094_relapse_time ctn0094_rela…¹</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                              <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>     1 ooooooooooooooo                                        1              1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>     4 -------------------o-o-o                              21              0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>    13 ------------o-oooooooooo                              15              1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>    17 --++*++++++-++++++-+++-                                3              1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>   163 -o---o---o--o+----------                              21              0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>   210 -++++++++-+++-----------                               2              1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>   233 *+++++++++++o++++++++++o                               1              1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>   242 -----------------------                               20              0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>  <span style="text-decoration: underline;">1</span>103 ++--oo--o-+-+--o----------o-o-oo++o                   31              1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>  <span style="text-decoration: underline;">2</span>089 ++++---+--------------o-                               1              1</span></span>
<span><span class="co">## <span style="color: #949494;"># … with abbreviated variable name ¹​ctn0094_relapse_event</span></span></span></code></pre>
</div>
<div class="section level4">
<h4 id="ctn-0094-dropout">CTN-0094 Dropout<a class="anchor" aria-label="anchor" href="#ctn-0094-dropout"></a>
</h4>
<p><strong>Definition</strong>: Weeks to study dropout (4 consecutive weeks of missing UOS)</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outcomesRel_df</span> <span class="op">&lt;-</span> </span>
<span>    <span class="va">outcomesRel_df</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">rowwise</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># do NOT recode any missing visits</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>        ctn0094_dropout <span class="op">=</span> <span class="fu"><a href="../reference/detect_in_window.html">detect_in_window</a></span><span class="op">(</span></span>
<span>            use_pattern <span class="op">=</span> <span class="va">usePatternUDS</span>,</span>
<span>            window_width <span class="op">=</span> <span class="fl">4L</span>,</span>
<span>            threshold <span class="op">=</span> <span class="fl">4L</span>,</span>
<span>            match_is <span class="op">=</span> <span class="st">"o"</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">unnest</span><span class="op">(</span>cols <span class="op">=</span> <span class="st">"ctn0094_dropout"</span>, names_sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">select</span><span class="op">(</span><span class="va">who</span>, <span class="fu">starts_with</span><span class="op">(</span><span class="st">"ctn0094_dropout"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">left_join</span><span class="op">(</span><span class="va">outcomesRel_df</span>, <span class="va">.</span>, by <span class="op">=</span> <span class="st">"who"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">outcomesRel_df</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">who</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">examplePeople_int</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">who</span>, <span class="va">usePatternUDS</span>, <span class="fu">starts_with</span><span class="op">(</span><span class="st">"ctn0094_dropout"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 10 × 4</span></span></span>
<span><span class="co">##      who usePatternUDS                       ctn0094_dropout_time ctn0094_drop…¹</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                              <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>     1 ooooooooooooooo                                        1              1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>     4 -------------------o-o-o                              21              0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>    13 ------------o-oooooooooo                              15              1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>    17 --++*++++++-++++++-+++-                               20              0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>   163 -o---o---o--o+----------                              21              0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>   210 -++++++++-+++-----------                              21              0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>   233 *+++++++++++o++++++++++o                              21              0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>   242 -----------------------                               20              0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>  <span style="text-decoration: underline;">1</span>103 ++--oo--o-+-+--o----------o-o-oo++o                   32              0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>  <span style="text-decoration: underline;">2</span>089 ++++---+--------------o-                              21              0</span></span>
<span><span class="co">## <span style="color: #949494;"># … with abbreviated variable name ¹​ctn0094_dropout_event</span></span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="johnson_controlled_1992">
<span class="citation">Johnson, Jaffe, and Fudala (1992)</span><a class="anchor" aria-label="anchor" href="#johnson_controlled_1992"></a>
</h3>
<p><strong>Definition</strong>: Failure rate: 2 consecutive positive UOS following 4 weeks of treatment; missing is positive</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outcomesRel_df</span> <span class="op">&lt;-</span> </span>
<span>    <span class="va">outcomesRel_df</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">rowwise</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>        udsPattern <span class="op">=</span> <span class="fu"><a href="../reference/recode_missing_visits.html">recode_missing_visits</a></span><span class="op">(</span></span>
<span>            use_pattern <span class="op">=</span> <span class="va">usePatternUDS</span>,</span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">mutate</span><span class="op">(</span></span>
<span>        udsPattern <span class="op">=</span> <span class="fu"><a href="../reference/recode_missing_visits.html">recode_missing_visits</a></span><span class="op">(</span></span>
<span>            use_pattern <span class="op">=</span> <span class="va">udsPattern</span>,</span>
<span>            missing_is <span class="op">=</span> <span class="st">"*"</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">mutate</span><span class="op">(</span></span>
<span>        johnson1992_hasRel <span class="op">=</span> <span class="fu"><a href="../reference/detect_subpattern.html">detect_subpattern</a></span><span class="op">(</span></span>
<span>            use_pattern <span class="op">=</span> <span class="va">udsPattern</span>,</span>
<span>            subpattern <span class="op">=</span> <span class="st">"++"</span>,</span>
<span>            <span class="co"># Starting at 4 weeks of treatment</span></span>
<span>            start <span class="op">=</span> <span class="fl">4L</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">select</span><span class="op">(</span><span class="va">who</span>, <span class="va">johnson1992_hasRel</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">left_join</span><span class="op">(</span><span class="va">outcomesRel_df</span>, <span class="va">.</span>, by <span class="op">=</span> <span class="st">"who"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">outcomesRel_df</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">who</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">examplePeople_int</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">who</span>, <span class="va">usePatternUDS</span>, <span class="va">johnson1992_hasRel</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 10 × 3</span></span></span>
<span><span class="co">##      who usePatternUDS                       johnson1992_hasRel</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                               <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>             </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>     1 ooooooooooooooo                     TRUE              </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>     4 -------------------o-o-o            FALSE             </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>    13 ------------o-oooooooooo            TRUE              </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>    17 --++*++++++-++++++-+++-             TRUE              </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>   163 -o---o---o--o+----------            TRUE              </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>   210 -++++++++-+++-----------            TRUE              </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>   233 *+++++++++++o++++++++++o            TRUE              </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>   242 -----------------------             FALSE             </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>  <span style="text-decoration: underline;">1</span>103 ++--oo--o-+-+--o----------o-o-oo++o TRUE              </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>  <span style="text-decoration: underline;">2</span>089 ++++---+--------------o-            FALSE</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="krupitsky_naltrexone_2004-and-krupitsky_naltrexone_2006">
<span class="citation">Evgeny M. Krupitsky et al. (2004)</span> and <span class="citation">Evgeny M. Krupitsky et al. (2006)</span><a class="anchor" aria-label="anchor" href="#krupitsky_naltrexone_2004-and-krupitsky_naltrexone_2006"></a>
</h3>
<p><strong>Definition</strong>: Relapse rate (3 consecutive positive UOS); missing is positive (their papers do not explicitly state what to do with missing UDS, but their previous protocols treated missing as positive).</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outcomesRel_df</span> <span class="op">&lt;-</span> </span>
<span>    <span class="va">outcomesRel_df</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">rowwise</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>        udsPattern <span class="op">=</span> <span class="fu"><a href="../reference/recode_missing_visits.html">recode_missing_visits</a></span><span class="op">(</span></span>
<span>            use_pattern <span class="op">=</span> <span class="va">usePatternUDS</span>,</span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">mutate</span><span class="op">(</span></span>
<span>        udsPattern <span class="op">=</span> <span class="fu"><a href="../reference/recode_missing_visits.html">recode_missing_visits</a></span><span class="op">(</span></span>
<span>            use_pattern <span class="op">=</span> <span class="va">udsPattern</span>,</span>
<span>            missing_is <span class="op">=</span> <span class="st">"*"</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">mutate</span><span class="op">(</span></span>
<span>        krupitsky2004_hasRel <span class="op">=</span> <span class="fu"><a href="../reference/detect_subpattern.html">detect_subpattern</a></span><span class="op">(</span></span>
<span>            use_pattern <span class="op">=</span> <span class="va">udsPattern</span>,</span>
<span>            subpattern <span class="op">=</span> <span class="st">"+++"</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">select</span><span class="op">(</span><span class="va">who</span>, <span class="va">krupitsky2004_hasRel</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">left_join</span><span class="op">(</span><span class="va">outcomesRel_df</span>, <span class="va">.</span>, by <span class="op">=</span> <span class="st">"who"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">outcomesRel_df</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">who</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">examplePeople_int</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">who</span>, <span class="va">usePatternUDS</span>, <span class="va">krupitsky2004_hasRel</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 10 × 3</span></span></span>
<span><span class="co">##      who usePatternUDS                       krupitsky2004_hasRel</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                               <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>               </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>     1 ooooooooooooooo                     TRUE                </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>     4 -------------------o-o-o            FALSE               </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>    13 ------------o-oooooooooo            TRUE                </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>    17 --++*++++++-++++++-+++-             TRUE                </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>   163 -o---o---o--o+----------            FALSE               </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>   210 -++++++++-+++-----------            TRUE                </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>   233 *+++++++++++o++++++++++o            TRUE                </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>   242 -----------------------             FALSE               </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>  <span style="text-decoration: underline;">1</span>103 ++--oo--o-+-+--o----------o-o-oo++o TRUE                </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>  <span style="text-decoration: underline;">2</span>089 ++++---+--------------o-            TRUE</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="lee_extended-release_2016">
<span class="citation">Joshua D. Lee et al. (2016)</span><a class="anchor" aria-label="anchor" href="#lee_extended-release_2016"></a>
</h3>
<p><strong>Definition</strong>: Weeks to relapse (≥10 days of opioid use in a 28‐day period [a positive UOS was computed as 5 days of opioid use]); missing is positive</p>
<p>We interpret their outcome as “two or more positive weekly UDS in a 4-week window”.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outcomesRel_df</span> <span class="op">&lt;-</span> </span>
<span>    <span class="va">outcomesRel_df</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">rowwise</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>        udsPattern <span class="op">=</span> <span class="fu"><a href="../reference/recode_missing_visits.html">recode_missing_visits</a></span><span class="op">(</span></span>
<span>            use_pattern <span class="op">=</span> <span class="va">usePatternUDS</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">mutate</span><span class="op">(</span></span>
<span>        udsPattern <span class="op">=</span> <span class="fu"><a href="../reference/recode_missing_visits.html">recode_missing_visits</a></span><span class="op">(</span></span>
<span>            use_pattern <span class="op">=</span> <span class="va">udsPattern</span>,</span>
<span>            missing_is <span class="op">=</span> <span class="st">"*"</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">mutate</span><span class="op">(</span></span>
<span>        lee2016_rel <span class="op">=</span> <span class="fu"><a href="../reference/detect_in_window.html">detect_in_window</a></span><span class="op">(</span></span>
<span>            use_pattern <span class="op">=</span> <span class="va">udsPattern</span>,</span>
<span>            window_width <span class="op">=</span> <span class="fl">4L</span>,</span>
<span>            threshold <span class="op">=</span> <span class="fl">2L</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">unnest</span><span class="op">(</span>cols <span class="op">=</span> <span class="st">"lee2016_rel"</span>, names_sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">select</span><span class="op">(</span><span class="va">who</span>, <span class="fu">starts_with</span><span class="op">(</span><span class="st">"lee2016_rel"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">left_join</span><span class="op">(</span><span class="va">outcomesRel_df</span>, <span class="va">.</span>, by <span class="op">=</span> <span class="st">"who"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">outcomesRel_df</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">who</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">examplePeople_int</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">who</span>, <span class="va">usePatternUDS</span>, <span class="fu">starts_with</span><span class="op">(</span><span class="st">"lee2016_rel"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 10 × 4</span></span></span>
<span><span class="co">##      who usePatternUDS                       lee2016_rel_time lee2016_rel_event</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>     1 ooooooooooooooo                                    3                 1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>     4 -------------------o-o-o                          21                 1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>    13 ------------o-oooooooooo                          14                 1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>    17 --++*++++++-++++++-+++-                            3                 1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>   163 -o---o---o--o+----------                          12                 1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>   210 -++++++++-+++-----------                           3                 1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>   233 *+++++++++++o++++++++++o                           3                 1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>   242 -----------------------                           22                 0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>  <span style="text-decoration: underline;">1</span>103 ++--oo--o-+-+--o----------o-o-oo++o                3                 1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>  <span style="text-decoration: underline;">2</span>089 ++++---+--------------o-                           3                 1</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="lee_comparative_2018">
<span class="citation">Joshua D. Lee et al. (2018)</span><a class="anchor" aria-label="anchor" href="#lee_comparative_2018"></a>
</h3>
<p><strong>Definition</strong>: Weeks to relapse (starting at day 21 post-randomization: 4 consecutive weeks with positive UOS); missing is positive</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outcomesRel_df</span> <span class="op">&lt;-</span> </span>
<span>    <span class="va">outcomesRel_df</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">rowwise</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>        udsPattern <span class="op">=</span> <span class="fu"><a href="../reference/recode_missing_visits.html">recode_missing_visits</a></span><span class="op">(</span></span>
<span>            use_pattern <span class="op">=</span> <span class="va">usePatternUDS</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">mutate</span><span class="op">(</span></span>
<span>        udsPattern <span class="op">=</span> <span class="fu"><a href="../reference/recode_missing_visits.html">recode_missing_visits</a></span><span class="op">(</span></span>
<span>            use_pattern <span class="op">=</span> <span class="va">udsPattern</span>,</span>
<span>            missing_is <span class="op">=</span> <span class="st">"*"</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">mutate</span><span class="op">(</span></span>
<span>        udsPatternTrimmed <span class="op">=</span> <span class="fu">str_sub</span><span class="op">(</span><span class="va">udsPattern</span>, start <span class="op">=</span> <span class="fl">3L</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">rowwise</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">mutate</span><span class="op">(</span></span>
<span>        lee2018_rel <span class="op">=</span> <span class="fu"><a href="../reference/detect_in_window.html">detect_in_window</a></span><span class="op">(</span></span>
<span>            use_pattern <span class="op">=</span> <span class="va">udsPatternTrimmed</span>,</span>
<span>            window_width <span class="op">=</span> <span class="fl">4L</span>,</span>
<span>            threshold <span class="op">=</span> <span class="fl">4L</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">unnest</span><span class="op">(</span>cols <span class="op">=</span> <span class="st">"lee2018_rel"</span>, names_sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">mutate</span><span class="op">(</span>lee2018_rel_time <span class="op">=</span> <span class="va">lee2018_rel_time</span> <span class="op">+</span> <span class="fl">2</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">select</span><span class="op">(</span><span class="va">who</span>, <span class="fu">starts_with</span><span class="op">(</span><span class="st">"lee2018_rel"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">left_join</span><span class="op">(</span><span class="va">outcomesRel_df</span>, <span class="va">.</span>, by <span class="op">=</span> <span class="st">"who"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">outcomesRel_df</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">who</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">examplePeople_int</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">who</span>, <span class="va">usePatternUDS</span>, <span class="fu">starts_with</span><span class="op">(</span><span class="st">"lee2018_rel"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 10 × 4</span></span></span>
<span><span class="co">##      who usePatternUDS                       lee2018_rel_time lee2018_rel_event</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>     1 ooooooooooooooo                                    3                 1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>     4 -------------------o-o-o                          21                 0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>    13 ------------o-oooooooooo                          15                 1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>    17 --++*++++++-++++++-+++-                            3                 1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>   163 -o---o---o--o+----------                          21                 0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>   210 -++++++++-+++-----------                           3                 1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>   233 *+++++++++++o++++++++++o                           3                 1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>   242 -----------------------                           20                 0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>  <span style="text-decoration: underline;">1</span>103 ++--oo--o-+-+--o----------o-o-oo++o               31                 1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>  <span style="text-decoration: underline;">2</span>089 ++++---+--------------o-                          21                 0</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="schottenfeld_maintenance_2008">
<span class="citation">Schottenfeld, Chawarski, and Mazlan (2008)</span><a class="anchor" aria-label="anchor" href="#schottenfeld_maintenance_2008"></a>
</h3>
<p><strong>Definition</strong>: Days to relapse (3 consecutive positive UOS); missing is positive</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outcomesRel_df</span> <span class="op">&lt;-</span> </span>
<span>    <span class="va">outcomesRel_df</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">rowwise</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>        udsPattern <span class="op">=</span> <span class="fu"><a href="../reference/recode_missing_visits.html">recode_missing_visits</a></span><span class="op">(</span></span>
<span>            use_pattern <span class="op">=</span> <span class="va">usePatternUDS</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">mutate</span><span class="op">(</span></span>
<span>        udsPattern <span class="op">=</span> <span class="fu"><a href="../reference/recode_missing_visits.html">recode_missing_visits</a></span><span class="op">(</span></span>
<span>            use_pattern <span class="op">=</span> <span class="va">udsPattern</span>,</span>
<span>            missing_is <span class="op">=</span> <span class="st">"*"</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">mutate</span><span class="op">(</span></span>
<span>        schottenfeld2008_rel <span class="op">=</span> <span class="fu"><a href="../reference/detect_in_window.html">detect_in_window</a></span><span class="op">(</span></span>
<span>            use_pattern <span class="op">=</span> <span class="va">udsPattern</span>,</span>
<span>            window_width <span class="op">=</span> <span class="fl">3L</span>,</span>
<span>            threshold <span class="op">=</span> <span class="fl">3L</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">unnest</span><span class="op">(</span>cols <span class="op">=</span> <span class="st">"schottenfeld2008_rel"</span>, names_sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">select</span><span class="op">(</span><span class="va">who</span>, <span class="fu">starts_with</span><span class="op">(</span><span class="st">"schottenfeld2008_rel"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">left_join</span><span class="op">(</span><span class="va">outcomesRel_df</span>, <span class="va">.</span>, by <span class="op">=</span> <span class="st">"who"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">outcomesRel_df</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">who</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">examplePeople_int</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">who</span>, <span class="va">usePatternUDS</span>, <span class="fu">starts_with</span><span class="op">(</span><span class="st">"schottenfeld2008_rel"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 10 × 4</span></span></span>
<span><span class="co">##      who usePatternUDS                       schottenfeld2008_rel_time schotte…¹</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                                   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>     1 ooooooooooooooo                                             1         1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>     4 -------------------o-o-o                                   22         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>    13 ------------o-oooooooooo                                   15         1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>    17 --++*++++++-++++++-+++-                                     3         1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>   163 -o---o---o--o+----------                                   22         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>   210 -++++++++-+++-----------                                    2         1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>   233 *+++++++++++o++++++++++o                                    1         1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>   242 -----------------------                                    21         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>  <span style="text-decoration: underline;">1</span>103 ++--oo--o-+-+--o----------o-o-oo++o                        31         1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>  <span style="text-decoration: underline;">2</span>089 ++++---+--------------o-                                    1         1</span></span>
<span><span class="co">## <span style="color: #949494;"># … with abbreviated variable name ¹​schottenfeld2008_rel_event</span></span></span></code></pre>
<hr>
<p></p>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-johnson_controlled_1992" class="csl-entry">
Johnson, Rolley E., Jerome H. Jaffe, and Paul J. Fudala. 1992. <span>“A <span>Controlled</span> <span>Trial</span> of <span>Buprenorphine</span> <span>Treatment</span> for <span>Opioid</span> <span>Dependence</span>.”</span> <em>Journal of the American Medical Association</em> 267 (20): 2750–55. <a href="https://doi.org/10.1001/jama.1992.03480200058024" class="external-link">https://doi.org/10.1001/jama.1992.03480200058024</a>.
</div>
<div id="ref-krupitsky_naltrexone_2006" class="csl-entry">
Krupitsky, Evgeny M., Edwin E. Zvartau, Dimitry V. Masalov, Marina V. Tsoy, Andrey M. Burakov, Valentina Y. Egorova, Tatyana Y. Didenko, et al. 2006. <span>“Naltrexone with or Without Fluoxetine for Preventing Relapse to Heroin Addiction in <span>St</span>. <span>Petersburg</span>, <span>Russia</span>.”</span> <em>Journal of Substance Abuse Treatment</em> 31 (4): 319–28. <a href="https://doi.org/10.1016/j.jsat.2006.05.005" class="external-link">https://doi.org/10.1016/j.jsat.2006.05.005</a>.
</div>
<div id="ref-krupitsky_naltrexone_2004" class="csl-entry">
Krupitsky, Evgeny M, Edwin E Zvartau, Dimitry V Masalov, Marina V Tsoi, Andrey M Burakov, Valentina Y Egorova, Tatyana Y Didenko, et al. 2004. <span>“Naltrexone for Heroin Dependence Treatment in <span>St</span>. <span>Petersburg</span>, <span>Russia</span>.”</span> <em>Journal of Substance Abuse Treatment</em> 26 (4): 285–94. <a href="https://doi.org/10.1016/j.jsat.2004.02.002" class="external-link">https://doi.org/10.1016/j.jsat.2004.02.002</a>.
</div>
<div id="ref-lee_extended-release_2016" class="csl-entry">
Lee, Joshua D., Peter D. Friedmann, Timothy W. Kinlock, Edward V. Nunes, Tamara Y. Boney, Randall A. Hoskinson, Donna Wilson, et al. 2016. <span>“Extended-<span>Release</span> <span>Naltrexone</span> to <span>Prevent</span> <span>Opioid</span> <span>Relapse</span> in <span>Criminal</span> <span>Justice</span> <span>Offenders</span>.”</span> <em>New England Journal of Medicine</em> 374 (13): 1232–42. <a href="https://doi.org/10.1056/NEJMoa1505409" class="external-link">https://doi.org/10.1056/NEJMoa1505409</a>.
</div>
<div id="ref-lee_comparative_2018" class="csl-entry">
Lee, Joshua D, Edward V Nunes, Patricia Novo, Ken Bachrach, Genie L Bailey, Snehal Bhatt, Sarah Farkas, et al. 2018. <span>“Comparative Effectiveness of Extended-Release Naltrexone Versus Buprenorphine-Naloxone for Opioid Relapse Prevention (<span>X</span>:<span>BOT</span>): A Multicentre, Open-Label, Randomised Controlled Trial.”</span> <em>The Lancet</em> 391 (10118): 309–18. <a href="https://doi.org/10.1016/S0140-6736(17)32812-X" class="external-link">https://doi.org/10.1016/S0140-6736(17)32812-X</a>.
</div>
<div id="ref-schottenfeld_maintenance_2008" class="csl-entry">
Schottenfeld, Richard S, Marek C Chawarski, and Mahmud Mazlan. 2008. <span>“Maintenance Treatment with Buprenorphine and Naltrexone for Heroin Dependence in <span>Malaysia</span>: A Randomised, Double-Blind, Placebo-Controlled Trial.”</span> <em>The Lancet</em> 371 (9631): 2192–2200. <a href="https://doi.org/10.1016/S0140-6736(08)60954-X" class="external-link">https://doi.org/10.1016/S0140-6736(08)60954-X</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://gabriel.quarto.pub/home/" class="external-link">Gabriel Odom</a>, <a href="https://www.ccny.cuny.edu/profiles/laura-brandt" class="external-link">Laura Brandt</a>, <a href="https://github.com/RaymondBalise" class="external-link">Raymond Balise</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>

<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Given a use pattern string, use fuzzy logic to detect if a
sub-pattern of interest is present within a specified detection window and
how many visits are required to find said match."><title>Detect Visits before Matching a Fuzzy Sub-Pattern — detect_in_window • CTNote</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Detect Visits before Matching a Fuzzy Sub-Pattern — detect_in_window"><meta property="og:description" content="Given a use pattern string, use fuzzy logic to detect if a
sub-pattern of interest is present within a specified detection window and
how many visits are required to find said match."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">CTNote</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-endpoints-library">Endpoints Library</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-endpoints-library">
    <a class="dropdown-item" href="../articles/library_abstinence_20220711.html">Abstinence Outcomes</a>
    <a class="dropdown-item" href="../articles/library_reduction_20220630.html">Use Reduction Outcomes</a>
    <a class="dropdown-item" href="../articles/library_relapse_20220711.html">Relapse Outcomes</a>
  </div>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Detect Visits before Matching a Fuzzy Sub-Pattern</h1>
      
      <div class="d-none name"><code>detect_in_window.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Given a use pattern string, use fuzzy logic to detect if a
sub-pattern of interest is present within a specified detection window and
how many visits are required to find said match.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">detect_in_window</span><span class="op">(</span></span>
<span>  <span class="va">use_pattern</span>,</span>
<span>  window_width <span class="op">=</span> <span class="fl">4L</span>,</span>
<span>  threshold <span class="op">=</span> <span class="fl">3L</span>,</span>
<span>  offset <span class="op">=</span> <span class="va">window_width</span> <span class="op">-</span> <span class="va">threshold</span>,</span>
<span>  match_is <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"+"</span>, <span class="st">"o"</span>, <span class="st">"-"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>use_pattern</dt>
<dd><p>A character string showing the daily, by visit, or weekly</p></dd>


<dt>window_width</dt>
<dd><p>How wide should the inspection window be? Defaults to
four visits.</p></dd>


<dt>threshold</dt>
<dd><p>How many successes or failures are required within the
specified window? Defaults to three.</p></dd>


<dt>offset</dt>
<dd><p>In the case of an event, where in the detection window should
the event time be recorded? Defaults to <code>window_width - threshold</code>;
that is, the start of the actual pattern. Another option would be 0, which
indicates that the event should be recorded at the start of the window in
which it was detected.</p></dd>


<dt>match_is</dt>
<dd><p>What constitutes the outcome of interest? <code>"+"</code>
represents positive UDS as the visit event of interest, <code>"-"</code> is
negative, and <code>"o"</code> means that the subject did not provide a valid UDS
during the time period in question.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A two column data frame with (a) column <code>time</code> representing the
number of visits until the first window with a match is detected and (b)
column <code>event</code> indicating if the match occurs in any window of the use
pattern.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function can be used to calculate time-to-event (survival)
metrics for the subjects in treatment. For example, the default arguments
represent a definition of relapse ("three or more positive UDS within a
four-week window"). Thus, the output of this function under default values
would be time until first relapse and a relapse indicator.</p>
<p>Concerning the <code>offset</code> argument: take, for example, the use pattern
<code>"-------++++"</code>. The subject began to use the substance(s) of interest
by week 8. If our relapse definition was to detect 4 weeks of use in a 4
week window, then the relapse time would be recorded at week 8. Similarly,
we would expect that if our relapse definition was to detect 2 or 3 weeks
of use in a 4 week window, that the relapse time would also be week 8. This
is why the default value of the <code>offset</code> argument is what it is: we
"shift" the detection of the use until the start of the use. However, if
you see the pattern above and believe that the relapse should be recorded
at week 7 for relapse defined as 3 weeks of use in a 4-week window or at
week 6 for 2 weeks of use in a 4-week window, then set <code>offset = 0</code>.</p>
<p>Defining the use symbols: at current, we allow for many symbols in the use
pattern "word", such as "_" for missing by study design, "o" missing for
protocol non-compliance (the most common form of missing), "+" for
positive, "-" for negative, and "*" for mixed positive and negative results
(this usually comes up when the visit represents multiple days and there
are both positive and negative results in those days; for example, a
subject is tested weekly; they provided a positive test on Tuesday but came
back to provide a negative test the following day).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  <span class="co"># Find the first relapse event</span></span></span>
<span class="r-in"><span>  <span class="fu">detect_in_window</span><span class="op">(</span><span class="st">"o-o+++"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   time event</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    4     1</span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co"># Find the start of the window that contains the first relapse event</span></span></span>
<span class="r-in"><span>  <span class="fu">detect_in_window</span><span class="op">(</span><span class="st">"o-o+++"</span>, offset <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   time event</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    3     1</span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co"># Find the first positive UDS</span></span></span>
<span class="r-in"><span>  <span class="fu">detect_in_window</span><span class="op">(</span><span class="st">"o-o+++"</span>, window_width <span class="op">=</span> <span class="fl">1L</span>, threshold <span class="op">=</span> <span class="fl">1L</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   time event</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    4     1</span>
<span class="r-in"><span>  </span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by <a href="https://gabriel.quarto.pub/home/" class="external-link">Gabriel Odom</a>, <a href="https://www.ccny.cuny.edu/profiles/laura-brandt" class="external-link">Laura Brandt</a>, <a href="https://github.com/RaymondBalise" class="external-link">Raymond Balise</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>


<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Given a use pattern string with missing visits, make naive
imputations for each missing visit"><title>Naively Impute Missing Visits — impute_missing_visits • CTNote</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Naively Impute Missing Visits — impute_missing_visits"><meta property="og:description" content="Given a use pattern string with missing visits, make naive
imputations for each missing visit"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">CTNote</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-endpoints-library">Endpoints Library</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-endpoints-library">
    <a class="dropdown-item" href="../articles/library_abstinence_20220711.html">Abstinence Outcomes</a>
    <a class="dropdown-item" href="../articles/library_reduction_20220630.html">Use Reduction Outcomes</a>
    <a class="dropdown-item" href="../articles/library_relapse_20220711.html">Relapse Outcomes</a>
  </div>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Naively Impute Missing Visits</h1>
      
      <div class="d-none name"><code>impute_missing_visits.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Given a use pattern string with missing visits, make naive
imputations for each missing visit</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">impute_missing_visits</span><span class="op">(</span></span>
<span>  <span class="va">use_pattern</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"locf"</span>, <span class="st">"locfD"</span>, <span class="st">"mode"</span>, <span class="st">"kNV"</span><span class="op">)</span>,</span>
<span>  missing_is <span class="op">=</span> <span class="st">"o"</span>,</span>
<span>  mixed_is <span class="op">=</span> <span class="st">"*"</span>,</span>
<span>  tiebreaker <span class="op">=</span> <span class="st">"+"</span>,</span>
<span>  k <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  knvWeights_num <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>o <span class="op">=</span> <span class="cn">NA</span>, `+` <span class="op">=</span> <span class="fl">1</span>, `*` <span class="op">=</span> <span class="fl">0.5</span>, `-` <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>  quietly <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>use_pattern</dt>
<dd><p>A character string showing the daily, by visit, or weekly
substance use pattern for a single subject</p></dd>


<dt>method</dt>
<dd><p>Which naive imputation method should be used? Current supported
options are <code>"locf"</code> (last observation carried forward),
<code>"locfD"</code> (last observation carried forward until dropout),
<code>"mode"</code> (most common non-missing value), and <code>"kNV"</code> (k nearest
visits).</p></dd>


<dt>missing_is</dt>
<dd><p>Which single character is used to mark missing UDS in a
use pattern string? Defaults to <code>"o"</code>.</p></dd>


<dt>mixed_is</dt>
<dd><p>Which single character is used to mark mixed UDS (both
positive and negative UDS for the visit block) in a use pattern string?
Defaults to <code>"*"</code>. When imputing by the mode, all mixed result UDS
will be assigned the <code>tiebreaker</code> value in order to calculate the mode
but will remain unchanged in the returned use pattern string.</p></dd>


<dt>tiebreaker</dt>
<dd><p>In the event of ties between two modes, should positive or
negative UDS be the mode? Defaults to positive (<code>"+"</code>).</p></dd>


<dt>k</dt>
<dd><p>The number of neaest visits to use in kNV imputation. This defaults
to 1; we recommend that this parameter stays at 1 unless the use patterns
in your data have extraordinarily few missing values.</p></dd>


<dt>knvWeights_num</dt>
<dd><p>A named vector matching the use pattern word "letters"
to their numerical use values. The names of this vector should match the
"letters" of the use pattern word exactly; use backticks to escape special
characters. For example, if the study protocol counts a mixed result (one
positive and one negative UDS in a single observation period [week]) as
worth three "use days", then mixed results should have a  weight of 3/7.
Additionally, a study protocol may count missing values as five "use days"
out of a week. The defaults for this function are to leave <code>"o"</code> as
missing (<code>NA</code>), and give weights of 1, 1/2, and 0 for visits with
<code>"+"</code>, <code>"*"</code>, and <code>"-"</code> UDS, respectively.</p></dd>


<dt>quietly</dt>
<dd><p>Should warning messages be muted? Defaults to <code>FALSE</code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A use pattern string the same length as <code>use_pattern</code> with
missing values imputed according to the chosen imputation method.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>If you would like to replace all UDS for missing visits with a
single, pre-specified value (such as positive), please use
<code><a href="recode_missing_visits.html">recode_missing_visits</a></code> instead. Furthermore, there will most
likely still be missing values in the use pattern even after imputation.
This would occur if all the values are missing, if the first values of the
use pattern are missing (if LOCF is used), if the first and/or last values
of the use pattern are missing (if LOCF-D is used), or if there are back to
back missing visits (if kNV with <code>k = 1</code> is used). Because of this,
you may need to call <code><a href="recode_missing_visits.html">recode_missing_visits</a></code> in a pipeline
after this function to replace or remove the remaining non-imputable
missing visits.</p>
<p>If you are using the kNV imputation option, there are some caveats to
consider. Due to rounding rules, any rounding ties are broken by order of
the values to the <code>knvWeights_num</code> vector. For instance, consider a
subject who had a negative UDS in one week, then a missing UDS for the next
week, and then two UDS in the following week (of which one was positive and
the other was negative). This is represented by the use pattern
<code>"-o*"</code>. The default behavior of the kNV method is to impute this to
<code>"-**"</code> because the order of the <code>knvWeights_num</code> vector has
<code>"+"</code>, then <code>"*"</code>, then <code>"-"</code> UDS values. In this order, a
positive result trumps a mixed result, and a mixed result trumps a negative
result. Similarly, the use pattern <code>"+o*"</code> will be imputed to
<code>"++*"</code> by default.</p>
<p>At current, we allow for many symbols in the use pattern "word", such as
"_" for missing by study design, "o" missing for protocol non-compliance
(the most common form of missing), "+" for positive, "-" for negative, and
"*" for mixed positive and negative results (this usually comes up when the
visit represents multiple days and there are both positive and negative
results in those days; for example, a subject is tested weekly; they
provided a positive test on Tuesday but came back to provide a negative
test the following day).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  <span class="va">pattern_char</span> <span class="op">&lt;-</span> <span class="st">"__++++*o-------+--+-o-o-o+o+oooooo"</span></span></span>
<span class="r-in"><span>  <span class="fu">impute_missing_visits</span><span class="op">(</span><span class="va">pattern_char</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "__++++**-------+--+------+++++++++"</span>
<span class="r-in"><span>  <span class="fu">impute_missing_visits</span><span class="op">(</span><span class="va">pattern_char</span>, method <span class="op">=</span> <span class="st">"locfD"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "__++++**-------+--+------+++oooooo"</span>
<span class="r-in"><span>  <span class="fu">impute_missing_visits</span><span class="op">(</span><span class="va">pattern_char</span>, method <span class="op">=</span> <span class="st">"mode"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "__++++*--------+--+------+-+------"</span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="va">pattern2_char</span> <span class="op">&lt;-</span> <span class="st">"ooooooooooo"</span></span></span>
<span class="r-in"><span>  <span class="fu">impute_missing_visits</span><span class="op">(</span><span class="va">pattern2_char</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>No non-missing visits. No imputation done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "ooooooooooo"</span>
<span class="r-in"><span>  </span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by <a href="https://gabriel.quarto.pub/home/" class="external-link">Gabriel Odom</a>, <a href="https://www.ccny.cuny.edu/profiles/laura-brandt" class="external-link">Laura Brandt</a>, <a href="https://github.com/RaymondBalise" class="external-link">Raymond Balise</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

